{
  "id": "tristopher_main_script_en",
  "version": "2.0.0",
  "metadata": {
    "author": "Tristopher Team", 
    "created_at": "2024-01-15T10:00:00Z",
    "description": "Main Tristopher script following user journey flowchart",
    "supported_languages": ["en"],
    "is_active": true
  },
  "global_variables": {
    "robot_personality_level": 5,
    "default_delay_ms": 1000,
    "is_onboarded": false,
    "has_task_set": false,
    "is_overdue": false,
    "is_on_notice": false,
    "has_visited_today": false,
    "current_streak": 0,
    "wager_amount": 0,
    "user_name": "",
    "current_task": "",
    "daily_deadline": "",
    "active_days": [],
    "notification_intensity": "medium",
    "wager_target": ""
  },
  "daily_events": [
    {
      "id": "check_in",
      "trigger": {
        "type": "app_start",
        "conditions": {}
      },
      "priority": 100,
      "variants": [
        {
          "id": "main_entry",
          "weight": 1.0,
          "conditions": {},
          "messages": [
            {
              "type": "conditional_flow",
              "sender": "system",
              "content": "Starting check-in flow",
              "nextEventId": "welcoming_sequence"
            }
          ]
        }
      ]
    },

    {
      "id": "welcoming_sequence",
      "trigger": {
        "type": "conditional",
        "conditions": {}
      },
      "priority": 99,
      "variants": [
        {
          "id": "check_onboarded",
          "weight": 1.0,
          "conditions": {
            "is_onboarded": false
          },
          "messages": [
            {
              "type": "flow_redirect",
              "nextEventId": "onboarding_sequence"
            }
          ]
        },
        {
          "id": "welcome_back",
          "weight": 1.0,
          "conditions": {
            "is_onboarded": true
          },
          "messages": [
            {
              "type": "text",
              "sender": "tristopher",
              "content": "Well, well, {{user_name}}. Back for more punishment, I see.",
              "delay": 1500
            },
            {
              "type": "flow_redirect",
              "nextEventId": "task_checking_sequence"
            }
          ]
        }
      ]
    },

    {
      "id": "onboarding_sequence",
      "trigger": {
        "type": "conditional",
        "conditions": {}
      },
      "priority": 98,
      "variants": [
        {
          "id": "ask_name",
          "weight": 1.0,
          "conditions": {},
          "messages": [
            {
              "type": "text",
              "sender": "tristopher",
              "content": "Oh, a fresh victim. How delightful.",
              "delay": 1500
            },
            {
              "type": "input",
              "sender": "tristopher",
              "content": "What should I call you while you inevitably disappoint me?",
              "inputConfig": {
                "hint": "Enter your name",
                "keyboardType": "TextInputType.text",
                "maxLength": 20
              },
              "nextEventId": "concept_explanation",
              "setVariables": {
                "user_name": "{{last_input}}"
              }
            }
          ]
        }
      ]
    },

    {
      "id": "concept_explanation",
      "trigger": {
        "type": "user_action",
        "conditions": {}
      },
      "priority": 97,
      "variants": [
        {
          "id": "explain_concept",
          "weight": 1.0,
          "conditions": {},
          "messages": [
            {
              "type": "text",
              "sender": "tristopher",
              "content": "{{user_name}}, let me explain how this works since you clearly need help.",
              "delay": 1500
            },
            {
              "type": "text",
              "sender": "tristopher",
              "content": "You set a daily habit. You put money at stake. You fail? That money goes to something you hate.",
              "delay": 2500
            },
            {
              "type": "text",
              "sender": "tristopher",
              "content": "It's called motivation through spite. Works better than your usual self-delusion.",
              "delay": 2000
            },
            {
              "type": "flow_redirect",
              "nextEventId": "set_onboarded",
              "setVariables": {
                "is_onboarded": true
              }
            }
          ]
        }
      ]
    },

    {
      "id": "set_onboarded",
      "trigger": {
        "type": "system",
        "conditions": {}
      },
      "priority": 96,
      "variants": [
        {
          "id": "onboarding_complete",
          "weight": 1.0,
          "conditions": {},
          "messages": [
            {
              "type": "flow_redirect",
              "nextEventId": "task_setting_sequence"
            }
          ]
        }
      ]
    },

    {
      "id": "task_checking_sequence",
      "trigger": {
        "type": "conditional",
        "conditions": {}
      },
      "priority": 95,
      "variants": [
        {
          "id": "no_task_set",
          "weight": 1.0,
          "conditions": {
            "has_task_set": false
          },
          "messages": [
            {
              "type": "flow_redirect",
              "nextEventId": "task_setting_sequence"
            }
          ]
        },
        {
          "id": "check_overdue",
          "weight": 1.0,
          "conditions": {
            "has_task_set": true
          },
          "messages": [
            {
              "type": "conditional_flow",
              "nextEventId": "overdue_check"
            }
          ]
        }
      ]
    },

    {
      "id": "overdue_check",
      "trigger": {
        "type": "conditional",
        "conditions": {}
      },
      "priority": 94,
      "variants": [
        {
          "id": "task_overdue",
          "weight": 1.0,
          "conditions": {
            "is_overdue": true
          },
          "messages": [
            {
              "type": "options",
              "sender": "tristopher",
              "content": "Your task was due. What's your pathetic excuse this time?",
              "options": [
                {
                  "id": "completed",
                  "text": "I completed it!",
                  "nextEventId": "success_sequence"
                },
                {
                  "id": "failed",
                  "text": "I failed...",
                  "nextEventId": "failure_sequence"
                },
                {
                  "id": "in_progress",
                  "text": "Still working on it",
                  "nextEventId": "check_on_notice_overdue"
                }
              ]
            }
          ]
        },
        {
          "id": "task_not_overdue",
          "weight": 1.0,
          "conditions": {
            "is_overdue": false
          },
          "messages": [
            {
              "type": "options",
              "sender": "tristopher",
              "content": "How's your task going, {{user_name}}? Try not to lie.",
              "options": [
                {
                  "id": "completed_early",
                  "text": "Already completed!",
                  "nextEventId": "disbelief_response"
                },
                {
                  "id": "in_progress_current",
                  "text": "Working on it",
                  "nextEventId": "encouragement"
                },
                {
                  "id": "not_started",
                  "text": "Haven't started yet",
                  "nextEventId": "snark_response"
                }
              ]
            }
          ]
        }
      ]
    },

    {
      "id": "check_on_notice_overdue",
      "trigger": {
        "type": "conditional",
        "conditions": {}
      },
      "priority": 93,
      "variants": [
        {
          "id": "already_on_notice",
          "weight": 1.0,
          "conditions": {
            "is_on_notice": true
          },
          "messages": [
            {
              "type": "flow_redirect",
              "nextEventId": "failure_sequence"
            }
          ]
        },
        {
          "id": "put_on_notice",
          "weight": 1.0,
          "conditions": {
            "is_on_notice": false
          },
          "messages": [
            {
              "type": "text",
              "sender": "tristopher",
              "content": "Fine. You're officially ON NOTICE. This is your last chance, {{user_name}}.",
              "delay": 2000
            },
            {
              "type": "text",
              "sender": "tristopher",
              "content": "Fail again and your wallet will feel the consequences.",
              "delay": 1500
            },
            {
              "type": "flow_redirect",
              "nextEventId": "sendoff_sequence",
              "setVariables": {
                "is_on_notice": true
              }
            }
          ]
        }
      ]
    },

    {
      "id": "disbelief_response",
      "trigger": {
        "type": "user_action",
        "conditions": {}
      },
      "priority": 92,
      "variants": [
        {
          "id": "disbelief",
          "weight": 1.0,
          "conditions": {},
          "messages": [
            {
              "type": "text",
              "sender": "tristopher",
              "content": "Already? Color me shocked. You actually did something productive.",
              "delay": 1500
            },
            {
              "type": "flow_redirect",
              "nextEventId": "success_sequence"
            }
          ]
        }
      ]
    },

    {
      "id": "encouragement",
      "trigger": {
        "type": "user_action",
        "conditions": {}
      },
      "priority": 91,
      "variants": [
        {
          "id": "encourage",
          "weight": 1.0,
          "conditions": {},
          "messages": [
            {
              "type": "text",
              "sender": "tristopher",
              "content": "Working on it? How refreshingly... average. Don't stop now, {{user_name}}.",
              "delay": 1500
            },
            {
              "type": "flow_redirect",
              "nextEventId": "sendoff_sequence"
            }
          ]
        }
      ]
    },

    {
      "id": "snark_response",
      "trigger": {
        "type": "user_action",
        "conditions": {}
      },
      "priority": 90,
      "variants": [
        {
          "id": "snark",
          "weight": 1.0,
          "conditions": {},
          "messages": [
            {
              "type": "text",
              "sender": "tristopher",
              "content": "Haven't started? What a surprise. Your procrastination skills are truly impressive, {{user_name}}.",
              "delay": 2000
            },
            {
              "type": "flow_redirect",
              "nextEventId": "sendoff_sequence"
            }
          ]
        }
      ]
    },

    {
      "id": "success_sequence",
      "trigger": {
        "type": "user_action",
        "conditions": {}
      },
      "priority": 89,
      "variants": [
        {
          "id": "congratulations",
          "weight": 1.0,
          "conditions": {},
          "messages": [
            {
              "type": "text",
              "sender": "tristopher",
              "content": "Well, well. {{user_name}} actually followed through. I'm genuinely surprised.",
              "delay": 1500
            },
            {
              "type": "text",
              "sender": "tristopher",
              "content": "Your streak is now {{current_streak}}. Don't let it go to your head.",
              "delay": 1500,
              "setVariables": {
                "current_streak": "{{current_streak + 1}}",
                "is_on_notice": false
              }
            },
            {
              "type": "options",
              "sender": "tristopher",
              "content": "Want to keep the same task or change it up? (Probably wise to change before you get bored)",
              "options": [
                {
                  "id": "keep_task",
                  "text": "Keep the same task",
                  "nextEventId": "sendoff_sequence"
                },
                {
                  "id": "change_task",
                  "text": "Set a new task",
                  "nextEventId": "task_setting_sequence"
                }
              ]
            }
          ]
        }
      ]
    },

    {
      "id": "failure_sequence",
      "trigger": {
        "type": "user_action",
        "conditions": {}
      },
      "priority": 88,
      "variants": [
        {
          "id": "check_excuse",
          "weight": 1.0,
          "conditions": {},
          "messages": [
            {
              "type": "options",
              "sender": "tristopher",
              "content": "Failed again? Do you have a valid excuse, or should I start counting your money?",
              "options": [
                {
                  "id": "valid_excuse",
                  "text": "I have a good reason",
                  "nextEventId": "excuse_handling"
                },
                {
                  "id": "no_excuse",
                  "text": "No excuse, I failed",
                  "nextEventId": "lose_wager"
                }
              ]
            }
          ]
        }
      ]
    },

    {
      "id": "excuse_handling",
      "trigger": {
        "type": "user_action",
        "conditions": {}
      },
      "priority": 87,
      "variants": [
        {
          "id": "check_if_on_notice",
          "weight": 1.0,
          "conditions": {
            "is_on_notice": false
          },
          "messages": [
            {
              "type": "text",
              "sender": "tristopher",
              "content": "Fine. I'll pause your streak this time. But you're now ON NOTICE.",
              "delay": 2000
            },
            {
              "type": "flow_redirect",
              "nextEventId": "sendoff_sequence",
              "setVariables": {
                "is_on_notice": true
              }
            }
          ]
        },
        {
          "id": "already_on_notice_excuse",
          "weight": 1.0,
          "conditions": {
            "is_on_notice": true
          },
          "messages": [
            {
              "type": "text",
              "sender": "tristopher",
              "content": "Another excuse? You were already on notice. Time to pay up.",
              "delay": 2000
            },
            {
              "type": "flow_redirect",
              "nextEventId": "lose_wager"
            }
          ]
        }
      ]
    },

    {
      "id": "lose_wager",
      "trigger": {
        "type": "system",
        "conditions": {}
      },
      "priority": 86,
      "variants": [
        {
          "id": "wager_lost",
          "weight": 1.0,
          "conditions": {},
          "messages": [
            {
              "type": "text",
              "sender": "tristopher",
              "content": "Congratulations, {{user_name}}. Your ${{wager_amount}} is now going to {{wager_target}}.",
              "delay": 2000
            },
            {
              "type": "text",
              "sender": "tristopher",
              "content": "Hope it was worth it. Your streak is reset to 0.",
              "delay": 1500
            },
            {
              "type": "options",
              "sender": "tristopher",
              "content": "Ready to try again with the same task, or do you want to switch to something easier?",
              "options": [
                {
                  "id": "keep_failed_task",
                  "text": "Keep the same task",
                  "nextEventId": "sendoff_sequence",
                  "setVariables": {
                    "current_streak": 0,
                    "is_on_notice": false
                  }
                },
                {
                  "id": "change_failed_task",
                  "text": "Set a new task",
                  "nextEventId": "task_setting_sequence",
                  "setVariables": {
                    "current_streak": 0,
                    "is_on_notice": false
                  }
                }
              ]
            }
          ]
        }
      ]
    },

    {
      "id": "task_setting_sequence",
      "trigger": {
        "type": "conditional",
        "conditions": {}
      },
      "priority": 85,
      "variants": [
        {
          "id": "input_task",
          "weight": 1.0,
          "conditions": {},
          "messages": [
            {
              "type": "input",
              "sender": "tristopher",
              "content": "What's your daily task going to be? Be specific, {{user_name}}.",
              "inputConfig": {
                "hint": "e.g., Exercise for 30 minutes",
                "keyboardType": "TextInputType.text",
                "maxLength": 100
              },
              "nextEventId": "task_time_input",
              "setVariables": {
                "current_task": "{{last_input}}",
                "has_task_set": true
              }
            }
          ]
        }
      ]
    },

    {
      "id": "task_time_input",
      "trigger": {
        "type": "user_action",
        "conditions": {}
      },
      "priority": 84,
      "variants": [
        {
          "id": "time_input",
          "weight": 1.0,
          "conditions": {},
          "messages": [
            {
              "type": "options",
              "sender": "tristopher",
              "content": "When should this be done by each day?",
              "options": [
                {
                  "id": "morning",
                  "text": "Morning (9 AM)",
                  "nextEventId": "frequency_input",
                  "setVariables": {
                    "daily_deadline": "09:00"
                  }
                },
                {
                  "id": "afternoon",
                  "text": "Afternoon (2 PM)",
                  "nextEventId": "frequency_input",
                  "setVariables": {
                    "daily_deadline": "14:00"
                  }
                },
                {
                  "id": "evening",
                  "text": "Evening (6 PM)",
                  "nextEventId": "frequency_input",
                  "setVariables": {
                    "daily_deadline": "18:00"
                  }
                },
                {
                  "id": "night",
                  "text": "Night (9 PM)",
                  "nextEventId": "frequency_input",
                  "setVariables": {
                    "daily_deadline": "21:00"
                  }
                }
              ]
            }
          ]
        }
      ]
    },

    {
      "id": "frequency_input",
      "trigger": {
        "type": "user_action",
        "conditions": {}
      },
      "priority": 83,
      "variants": [
        {
          "id": "active_days",
          "weight": 1.0,
          "conditions": {},
          "messages": [
            {
              "type": "options",
              "sender": "tristopher",
              "content": "Which days will you inevitably fail at this?",
              "options": [
                {
                  "id": "weekdays",
                  "text": "Weekdays only",
                  "nextEventId": "notification_intensity_input",
                  "setVariables": {
                    "active_days": ["monday", "tuesday", "wednesday", "thursday", "friday"]
                  }
                },
                {
                  "id": "everyday",
                  "text": "Every day",
                  "nextEventId": "notification_intensity_input",
                  "setVariables": {
                    "active_days": ["monday", "tuesday", "wednesday", "thursday", "friday", "saturday", "sunday"]
                  }
                },
                {
                  "id": "weekends",
                  "text": "Weekends only",
                  "nextEventId": "notification_intensity_input",
                  "setVariables": {
                    "active_days": ["saturday", "sunday"]
                  }
                }
              ]
            }
          ]
        }
      ]
    },

    {
      "id": "notification_intensity_input",
      "trigger": {
        "type": "user_action",
        "conditions": {}
      },
      "priority": 82,
      "variants": [
        {
          "id": "notification_intensity",
          "weight": 1.0,
          "conditions": {},
          "messages": [
            {
              "type": "options",
              "sender": "tristopher",
              "content": "How often should I remind you of your impending failure?",
              "options": [
                {
                  "id": "gentle",
                  "text": "Be gentle with me",
                  "nextEventId": "wager_check",
                  "setVariables": {
                    "notification_intensity": "low"
                  }
                },
                {
                  "id": "normal",
                  "text": "Normal reminders",
                  "nextEventId": "wager_check",
                  "setVariables": {
                    "notification_intensity": "medium"
                  }
                },
                {
                  "id": "aggressive",
                  "text": "Be relentless",
                  "nextEventId": "wager_check",
                  "setVariables": {
                    "notification_intensity": "high"
                  }
                }
              ]
            }
          ]
        }
      ]
    },

    {
      "id": "wager_check",
      "trigger": {
        "type": "user_action",
        "conditions": {}
      },
      "priority": 81,
      "variants": [
        {
          "id": "ready_for_wager",
          "weight": 1.0,
          "conditions": {},
          "messages": [
            {
              "type": "options",
              "sender": "tristopher",
              "content": "Ready to put your money where your mouth is?",
              "options": [
                {
                  "id": "yes_wager",
                  "text": "Yes, let's set a wager",
                  "nextEventId": "wager_sequence"
                },
                {
                  "id": "no_wager",
                  "text": "Not ready for wagers yet",
                  "nextEventId": "sendoff_sequence"
                }
              ]
            }
          ]
        }
      ]
    },

    {
      "id": "wager_sequence",
      "trigger": {
        "type": "user_action",
        "conditions": {}
      },
      "priority": 80,
      "variants": [
        {
          "id": "wager_amount",
          "weight": 1.0,
          "conditions": {},
          "messages": [
            {
              "type": "options",
              "sender": "tristopher",
              "content": "How much are you willing to lose when you fail?",
              "options": [
                {
                  "id": "small",
                  "text": "$5 - Testing the waters",
                  "nextEventId": "target_choice",
                  "setVariables": {
                    "wager_amount": 5
                  }
                },
                {
                  "id": "medium",
                  "text": "$20 - Getting serious",
                  "nextEventId": "target_choice",
                  "setVariables": {
                    "wager_amount": 20
                  }
                },
                {
                  "id": "large",
                  "text": "$50 - High stakes",
                  "nextEventId": "target_choice",
                  "setVariables": {
                    "wager_amount": 50
                  }
                }
              ]
            }
          ]
        }
      ]
    },

    {
      "id": "target_choice",
      "trigger": {
        "type": "user_action",
        "conditions": {}
      },
      "priority": 79,
      "variants": [
        {
          "id": "anti_charity",
          "weight": 1.0,
          "conditions": {},
          "messages": [
            {
              "type": "options",
              "sender": "tristopher",
              "content": "Where should your failure money go? Pick something you'd hate to support:",
              "options": [
                {
                  "id": "political_opposite",
                  "text": "Political party I oppose",
                  "nextEventId": "wager_confirmed",
                  "setVariables": {
                    "wager_target": "a political organization you oppose"
                  }
                },
                {
                  "id": "corporate_enemy",
                  "text": "Company I dislike",
                  "nextEventId": "wager_confirmed", 
                  "setVariables": {
                    "wager_target": "a company you dislike"
                  }
                },
                {
                  "id": "rival_sports",
                  "text": "Rival sports team",
                  "nextEventId": "wager_confirmed",
                  "setVariables": {
                    "wager_target": "your rival sports team"
                  }
                }
              ]
            }
          ]
        }
      ]
    },

    {
      "id": "wager_confirmed",
      "trigger": {
        "type": "user_action",
        "conditions": {}
      },
      "priority": 78,
      "variants": [
        {
          "id": "wager_set",
          "weight": 1.0,
          "conditions": {},
          "messages": [
            {
              "type": "text",
              "sender": "tristopher",
              "content": "Perfect. ${{wager_amount}} to {{wager_target}} when you fail at {{current_task}}.",
              "delay": 2000
            },
            {
              "type": "text",
              "sender": "tristopher",
              "content": "This should be... entertaining.",
              "delay": 1500
            },
            {
              "type": "flow_redirect",
              "nextEventId": "sendoff_sequence"
            }
          ]
        }
      ]
    },

    {
      "id": "sendoff_sequence",
      "trigger": {
        "type": "conditional",
        "conditions": {}
      },
      "priority": 77,
      "variants": [
        {
          "id": "check_visited_today",
          "weight": 1.0,
          "conditions": {
            "has_visited_today": false
          },
          "messages": [
            {
              "type": "text",
              "sender": "tristopher",
              "content": "Remember, {{user_name}}: {{current_task}} by {{daily_deadline}}. Your wallet is watching.",
              "delay": 1500
            },
            {
              "type": "text",
              "sender": "tristopher",
              "content": "Try not to disappoint me. Actually, please do - it's more fun for me.",
              "delay": 2000,
              "setVariables": {
                "has_visited_today": true
              }
            }
          ]
        },
        {
          "id": "already_visited",
          "weight": 1.0,
          "conditions": {
            "has_visited_today": true
          },
          "messages": [
            {
              "type": "text",
              "sender": "tristopher",
              "content": "Back again? Either very dedicated or very procrastinating. I know which one I'd bet on.",
              "delay": 1500
            }
          ]
        }
      ]
    }
  ],
  "plot_timeline": {},
  "message_templates": {
    "daily_greeting": {
      "text": "Day {{day_number}} of your streak, {{user_name}}. Try not to ruin it.",
      "variables": ["day_number", "user_name"]
    },
    "task_reminder": {
      "text": "{{current_task}} deadline: {{daily_deadline}}. Tick tock.",
      "variables": ["current_task", "daily_deadline"]
    },
    "wager_reminder": {
      "text": "Fail and ${{wager_amount}} goes to {{wager_target}}. Feeling motivated yet?",
      "variables": ["wager_amount", "wager_target"]
    },
    "streak_status": {
      "text": "Current streak: {{current_streak}} days. {{#if is_on_notice}}You're ON NOTICE.{{/if}}",
      "variables": ["current_streak", "is_on_notice"]
    }
  }
}